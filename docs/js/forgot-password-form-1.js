document.addEventListener("DOMContentLoaded",function(){function a(){console.log("forgot password 2 js loaded");const a=document.querySelector("#forgot-password-form-2");class e{constructor({id:e="",doc:t=document,name:s,validation:a=""}){this.element=t.querySelector("#"+e),this.parent=this.element.parentElement,this.error=this.parent.querySelector(".alart-text"),this.validation=a,this.name=s,this.element.addEventListener("focus",()=>this.cleanError()),this.element.addEventListener("blur",()=>this.handleInput())}get isValid(){return this.validation.test(this.element.value)}handleInput(){!1===this.isValid?(this.parent.classList.add("warning"),this.error.style.display="flex"):(e.HAS_SUBMITTED&&e.ALL_VALID&&(o.disabled=!1),this.cleanError())}cleanError(){this.parent.classList.remove("warning"),this.error&&(this.error.style.display="none")}}const r={code:new e({id:"forgot-password-2-code",name:"forgot-password-2-code",validation:/[\s\S]*/}),password:new e({id:"forgot-password-2-password",name:"forgot-password-2-password",validation:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*#?&])[a-zA-Z\d@$!%*#?&]{8,}$/})},n=(r.confirmPassword=new class extends e{constructor({id:e="",doc:t=document,name:s,elemId:a="signup-password"}){super({id:e,name:s}),this.elem2=t.querySelector("#"+a),this.element.addEventListener("focus",()=>this.cleanError())}get isValid(){return this.element.value===this.elem2.value}handleInput(){var e=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*#?&])[a-zA-Z\d@$!%*#?&]{8,}$/.test(this.elem2.value);this.element.value.length&&e&&super.handleInput()}}({id:"forgot-password-2-confirm-password",name:"forgot-password-2-confirm-password",elemId:"forgot-password-2-password"}),Object.keys(r)),o=a.querySelector("#form-submit-2");var i=!(o.onclick=function(e){e.preventDefault();let t=o.disabled=!0;if(!1===i){i=!0;for(var s of n)r[s].element.addEventListener("input",()=>{!0===o.disabled&&(o.disabled=!function(){var e=!0;for(var t of n)if(!1===r[t].isValid){e=!1;break}return e}())})}var a;for(a of Object.keys(r)){const n=r[a];n.handleInput(),1==t&&!1===n.isValid&&(t=!1)}!1!==t&&l()});async function l(e){o.innerHTML="Saving";e=await async function(e){var t={message:"",errorMessage:null,status:null},e=await fetch("https://api.accbuddy.com/public",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({confirmForgotPassword:{token:e,user:{username:window.forgotPasswordEmail,password:r.password.element.value,code:r.code.element.value}}})}),s=await e.json();if(e.ok||400!=e.status){if(e.ok){const e=s.result;t.message=e,a.reset()}}else{const a=s.error;t.status=e.status,t.errorMessage=a}return console.log("normalized result",t),t}(e);o.innerHTML="Save";let t=document.querySelector("#plank-error-id-2");if(null!==e.errorMessage)t.classList.remove("hidden"),t.querySelector("#plank-close-2").addEventListener("click",()=>{t.classList.add("hidden")}),o.disabled=!0;else{const e=document.querySelector(".ab-auth-content-wrap-box.reset-success-massage");a.classList.add("hidden"),o.disabled=!1,e&&e.classList.add("success-massage-open")}}document.querySelector("#forgot-sign-in").onclick=()=>{window.location.assign(window.location.href.replace("reset-password.html","signin.html"))},window.handleSubmit=l;{var t=document.querySelectorAll(".toggle-eye");let s=!1;t.forEach(e=>{const t=e.parentElement.parentElement.querySelector('input[type="password"]');e.addEventListener("click",()=>{s=!s,t.type=s?"text":"password"})})}}console.log("forgot password js loaded");const r=document.querySelector("#forgot-password-form-1");const n={email:new class t{constructor({id:e="",doc:t=document,name:s,validation:a="",validateOnEmptyOnly:r=!1}){this.element=t.querySelector("#"+e),this.parent=this.element.parentElement,this.error=this.parent.querySelector(".alart-text"),this.validation=a,this.name=s,this.validateOnEmptyOnly=r,this.element.addEventListener("focus",()=>this.cleanError()),this.element.addEventListener("blur",()=>this.handleInput())}get isValid(){return!1!==this.validateOnEmptyOnly&&(!this.validateOnEmptyOnly||0!==this.element.value.length)||this.validation.test(this.element.value)}handleInput(){!1===this.isValid?(this.parent.classList.add("warning"),this.error.style.display="flex"):(t.HAS_SUBMITTED&&t.ALL_VALID&&(i.disabled=!1),this.cleanError())}cleanError(){this.parent.classList.remove("warning"),this.error.style.display="none"}}({id:"forgot-email",name:"email",validation:/^[^\s@]+@[^\s@]+\.[^\s@]+$/})},o=Object.keys(n),i=r.querySelector("#form-submit-1");var e,l=!(i.onclick=function(e){e.preventDefault(),i.disabled=!0,i.innerHTML="Sending";let t=!0;if(!1===l){l=!0;for(var s of o)n[s].element.addEventListener("input",()=>{!0===i.disabled&&(i.disabled=!function(){var e=!0;for(var t of o)if(!1===n[t].isValid){e=!1;break}return e}())})}const a=Object.keys(n);for(var r of a){const a=n[r];a.handleInput(),1==t&&!1===a.isValid&&(t=!1)}!1!==t&&grecaptcha.execute()});window.handleSubmit=async function(e){var t=n.email.element.value,e=(i.disabled=!0,await async function(e){var t={message:"",errorMessage:null,status:null},s=await fetch("https://api.accbuddy.com/public",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({forgotPassword:{token:e,user:{username:n.email.element.value}}})}),a=await s.json();if(s.ok||400!=s.status){if(s.ok){const e=a.result;t.message=e,r.reset()}}else{const e=a.error;t.status=s.status,t.errorMessage=e}return console.log("normalized result",t),t}(e));i.innerHTML="Next";let s=document.querySelector("#plank-error-id");if(null!==e.errorMessage){s.classList.remove("hidden");const a=s.querySelector("#plank-close");i.disabled=!1,a.addEventListener("click",()=>{s.classList.add("hidden")}),i.disabled=!0}else{a(),window.forgotPasswordEmail=t;const e=document.querySelector("#forgot-password-form-2");e&&(r.classList.add("hidden"),e.classList.remove("hidden"))}grecaptcha.reset()},(e=document.createElement("div")).innerHTML="<div class='g-recaptcha' data-sitekey='6LcShYkmAAAAAA_FN5w0Oewh_-7XzIocjZlX6apw'data-callback='handleSubmit' data-size='invisible'></div>",e=e.firstElementChild,r.appendChild(e),(e=document.createElement("script")).src="https://www.google.com/recaptcha/api.js",e.async=!0,e.defer=!0,document.head.appendChild(e)});